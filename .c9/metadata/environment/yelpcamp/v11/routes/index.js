{"filter":false,"title":"index.js","tooltip":"/yelpcamp/v11/routes/index.js","undoManager":{"mark":16,"position":16,"stack":[[{"start":{"row":0,"column":0},"end":{"row":0,"column":1},"action":"insert","lines":[" "],"id":2}],[{"start":{"row":31,"column":21},"end":{"row":31,"column":22},"action":"insert","lines":[","],"id":3}],[{"start":{"row":31,"column":22},"end":{"row":31,"column":24},"action":"insert","lines":["{}"],"id":4}],[{"start":{"row":31,"column":23},"end":{"row":31,"column":24},"action":"insert","lines":["m"],"id":5},{"start":{"row":31,"column":24},"end":{"row":31,"column":25},"action":"insert","lines":["e"]},{"start":{"row":31,"column":25},"end":{"row":31,"column":26},"action":"insert","lines":["s"]},{"start":{"row":31,"column":26},"end":{"row":31,"column":27},"action":"insert","lines":["s"]},{"start":{"row":31,"column":27},"end":{"row":31,"column":28},"action":"insert","lines":["a"]},{"start":{"row":31,"column":28},"end":{"row":31,"column":29},"action":"insert","lines":["g"]},{"start":{"row":31,"column":29},"end":{"row":31,"column":30},"action":"insert","lines":["e"]}],[{"start":{"row":31,"column":30},"end":{"row":31,"column":31},"action":"insert","lines":[":"],"id":6}],[{"start":{"row":31,"column":31},"end":{"row":31,"column":32},"action":"insert","lines":["r"],"id":7},{"start":{"row":31,"column":32},"end":{"row":31,"column":33},"action":"insert","lines":["e"]},{"start":{"row":31,"column":33},"end":{"row":31,"column":34},"action":"insert","lines":["q"]},{"start":{"row":31,"column":34},"end":{"row":31,"column":35},"action":"insert","lines":["."]},{"start":{"row":31,"column":35},"end":{"row":31,"column":36},"action":"insert","lines":["f"]}],[{"start":{"row":31,"column":36},"end":{"row":31,"column":37},"action":"insert","lines":["l"],"id":8},{"start":{"row":31,"column":37},"end":{"row":31,"column":38},"action":"insert","lines":["a"]},{"start":{"row":31,"column":38},"end":{"row":31,"column":39},"action":"insert","lines":["s"]},{"start":{"row":31,"column":39},"end":{"row":31,"column":40},"action":"insert","lines":["h"]}],[{"start":{"row":31,"column":40},"end":{"row":31,"column":42},"action":"insert","lines":["()"],"id":9}],[{"start":{"row":31,"column":41},"end":{"row":31,"column":43},"action":"insert","lines":["\"\""],"id":10}],[{"start":{"row":31,"column":42},"end":{"row":31,"column":43},"action":"insert","lines":["e"],"id":11},{"start":{"row":31,"column":43},"end":{"row":31,"column":44},"action":"insert","lines":["r"]},{"start":{"row":31,"column":44},"end":{"row":31,"column":45},"action":"insert","lines":["r"]},{"start":{"row":31,"column":45},"end":{"row":31,"column":46},"action":"insert","lines":["o"]},{"start":{"row":31,"column":46},"end":{"row":31,"column":47},"action":"insert","lines":["e"]}],[{"start":{"row":31,"column":46},"end":{"row":31,"column":47},"action":"remove","lines":["e"],"id":12}],[{"start":{"row":31,"column":46},"end":{"row":31,"column":47},"action":"insert","lines":["r"],"id":13}],[{"start":{"row":31,"column":49},"end":{"row":31,"column":50},"action":"remove","lines":["}"],"id":14},{"start":{"row":31,"column":48},"end":{"row":31,"column":49},"action":"remove","lines":[")"]},{"start":{"row":31,"column":47},"end":{"row":31,"column":48},"action":"remove","lines":["\""]},{"start":{"row":31,"column":46},"end":{"row":31,"column":47},"action":"remove","lines":["r"]},{"start":{"row":31,"column":45},"end":{"row":31,"column":46},"action":"remove","lines":["o"]},{"start":{"row":31,"column":44},"end":{"row":31,"column":45},"action":"remove","lines":["r"]},{"start":{"row":31,"column":43},"end":{"row":31,"column":44},"action":"remove","lines":["r"]},{"start":{"row":31,"column":42},"end":{"row":31,"column":43},"action":"remove","lines":["e"]},{"start":{"row":31,"column":41},"end":{"row":31,"column":42},"action":"remove","lines":["\""]},{"start":{"row":31,"column":40},"end":{"row":31,"column":42},"action":"remove","lines":["()"]},{"start":{"row":31,"column":39},"end":{"row":31,"column":40},"action":"remove","lines":["h"]},{"start":{"row":31,"column":38},"end":{"row":31,"column":39},"action":"remove","lines":["s"]},{"start":{"row":31,"column":37},"end":{"row":31,"column":38},"action":"remove","lines":["a"]},{"start":{"row":31,"column":36},"end":{"row":31,"column":37},"action":"remove","lines":["l"]},{"start":{"row":31,"column":35},"end":{"row":31,"column":36},"action":"remove","lines":["f"]},{"start":{"row":31,"column":34},"end":{"row":31,"column":35},"action":"remove","lines":["."]},{"start":{"row":31,"column":33},"end":{"row":31,"column":34},"action":"remove","lines":["q"]},{"start":{"row":31,"column":32},"end":{"row":31,"column":33},"action":"remove","lines":["e"]},{"start":{"row":31,"column":31},"end":{"row":31,"column":32},"action":"remove","lines":["r"]},{"start":{"row":31,"column":30},"end":{"row":31,"column":31},"action":"remove","lines":[":"]},{"start":{"row":31,"column":29},"end":{"row":31,"column":30},"action":"remove","lines":["e"]},{"start":{"row":31,"column":28},"end":{"row":31,"column":29},"action":"remove","lines":["g"]},{"start":{"row":31,"column":27},"end":{"row":31,"column":28},"action":"remove","lines":["a"]}],[{"start":{"row":31,"column":26},"end":{"row":31,"column":27},"action":"remove","lines":["s"],"id":15},{"start":{"row":31,"column":25},"end":{"row":31,"column":26},"action":"remove","lines":["s"]},{"start":{"row":31,"column":24},"end":{"row":31,"column":25},"action":"remove","lines":["e"]},{"start":{"row":31,"column":23},"end":{"row":31,"column":24},"action":"remove","lines":["m"]},{"start":{"row":31,"column":22},"end":{"row":31,"column":23},"action":"remove","lines":["{"]},{"start":{"row":31,"column":21},"end":{"row":31,"column":22},"action":"remove","lines":[","]}],[{"start":{"row":31,"column":21},"end":{"row":31,"column":22},"action":"insert","lines":[")"],"id":16}],[{"start":{"row":0,"column":0},"end":{"row":57,"column":0},"action":"remove","lines":[" var express = require(\"express\");","var router  = express.Router();","var passport = require(\"passport\");","var User = require(\"../models/user\");","","//root route","router.get(\"/\", function(req, res){","    res.render(\"landing\");","});","","// show register form","router.get(\"/register\", function(req, res){","   res.render(\"register\"); ","});","","//handle sign up logic","router.post(\"/register\", function(req, res){","    var newUser = new User({username: req.body.username});","    User.register(newUser, req.body.password, function(err, user){","        if(err){","            console.log(err);","            return res.render(\"register\");","        }","        passport.authenticate(\"local\")(req, res, function(){","           res.redirect(\"/campgrounds\"); ","        });","    });","});","","//show login form","router.get(\"/login\", function(req, res){","   res.render(\"login\"); ","});","","//handling login logic","router.post(\"/login\", passport.authenticate(\"local\", ","    {","        successRedirect: \"/campgrounds\",","        failureRedirect: \"/login\"","    }), function(req, res){","});","","// logout route","router.get(\"/logout\", function(req, res){","   req.logout();","   res.redirect(\"/campgrounds\");","});","","//middleware","function isLoggedIn(req, res, next){","    if(req.isAuthenticated()){","        return next();","    }","    res.redirect(\"/login\");","}","","module.exports = router;",""],"id":17}],[{"start":{"row":0,"column":0},"end":{"row":52,"column":24},"action":"insert","lines":["var express = require(\"express\");","var router  = express.Router();","var passport = require(\"passport\");","var User = require(\"../models/user\");","","//root route","router.get(\"/\", function(req, res){","    res.render(\"landing\");","});","","// show register form","router.get(\"/register\", function(req, res){","   res.render(\"register\"); ","});","","//handle sign up logic","router.post(\"/register\", function(req, res){","    var newUser = new User({username: req.body.username});","    User.register(newUser, req.body.password, function(err, user){","        if(err){","            req.flash(\"error\", err.message);","            return res.render(\"register\");","        }","        passport.authenticate(\"local\")(req, res, function(){","           req.flash(\"success\", \"Welcome to YelpCamp \" + user.username);","           res.redirect(\"/campgrounds\"); ","        });","    });","});","","//show login form","router.get(\"/login\", function(req, res){","   res.render(\"login\"); ","});","","//handling login logic","router.post(\"/login\", passport.authenticate(\"local\", ","    {","        successRedirect: \"/campgrounds\",","        failureRedirect: \"/login\"","    }), function(req, res){","});","","// logout route","router.get(\"/logout\", function(req, res){","   req.logout();","   req.flash(\"success\", \"Logged you out!\");","   res.redirect(\"/campgrounds\");","});","","","","module.exports = router;"],"id":18}]]},"ace":{"folds":[],"scrolltop":409,"scrollleft":0,"selection":{"start":{"row":52,"column":24},"end":{"row":52,"column":24},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1595047789610,"hash":"2259bfd8251f18aec14193306bed59b4009295f6"}